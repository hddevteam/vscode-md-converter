# 一键Markdown转换器 - VS Code扩展

[English](README.md) | **中文** | **[🌐 网站](https://hddevteam.github.io/vscode-md-converter/zh-cn.html)**

一个功能强大的VS Code扩展，只需一键即可将各种文档格式转换为Markdown和文本格式。

## 🚀 功能特性

### 支持的文档类型
- **Word文档** (.docx, .doc) → Markdown
- **Markdown文件** (.md, .markdown) → Word文档 (.docx) ⭐ **v0.4.0新增**
- **Excel表格** (.xlsx, .xls, .csv) → Markdown表格
- **Excel表格** (.xlsx, .xls) → CSV文件
- **PDF文档** (.pdf) → 文本文件
- **PDF文档** (.pdf) → PNG图片 *(需要poppler-utils工具)*
- **PowerPoint演示文稿** (.pptx, .ppt) → Markdown

### 🆕 v0.4.0 新功能
- **📝 Markdown转Word** - 将Markdown文件转换为专业Word文档，支持完整格式保留
- **📋 HTML列表支持** - 完整支持表格单元格中的HTML列表，带有适当的Word格式
- **🔥 多文件选择** - 在VS Code资源管理器中选择多个文件，一次性全部转换为Markdown
- **🎛️ 可配置信息块** - 选择要在转换的Markdown中包含的信息：
  - 文件标题头和来源声明
  - 文件元数据（大小、修改日期、创建日期）
  - 文档特定元数据（作者、工作表数量、幻灯片数量）
  - 转换警告和内容标题
  - 分节符和自定义格式
- ** PDF页面范围导出** - 导出指定页面为文本或图片
- **📊 Excel工作表范围导出** - 导出选定工作表为Markdown/CSV
- **🎨 PowerPoint幻灯片范围导出** - 转换指定幻灯片为Markdown
- **� 混合文件类型支持** - 在单次操作中处理Word、Excel和PowerPoint文件
- **💾 偏好设置持久化** - 记住您对信息块的选择，用于将来的转换
- **📊 智能进度报告** - 实时转换进度和详细状态更新

### 核心功能
- ✅ **右键菜单集成** - 直接在文件资源管理器中转换
- ✅ **命令面板支持** - 通过 Cmd+Shift+P 访问
- ✅ **多选转换** - 选择多个文件一次性转换为Markdown，支持自定义输出信息
- ✅ **批量转换** - 选择文件夹进行批量处理
- ✅ **范围选择** - 选择特定页面、工作表或幻灯片进行转换
- ✅ **智能文本处理** - 自动优化转换质量
- ✅ **进度指示器** - 实时显示转换进度
- ✅ **错误处理** - 完善的错误提示和处理
- ✅ **多语言支持** - 中英文界面自动切换
- ✅ **性能优化** - 高效处理大型文档

## 📦 安装

1. 在VS Code中打开扩展市场 (Ctrl+Shift+X)
2. 搜索 "Document MD Converter"
3. 点击安装

或者手动安装：
```bash
# 克隆项目
git clone https://github.com/hddevteam/vscode-md-converter.git
cd vscode-md-converter

# 安装依赖
npm install

# 编译扩展
npm run compile

# 在VS Code中按F5进行调试
```

## 🎯 使用方法

### 单文件转换
1. **右键菜单**: 在文件资源管理器中右键点击文档文件，选择相应的转换选项
2. **命令面板**: 
   - 按 `Cmd+Shift+P` (macOS) 或 `Ctrl+Shift+P` (Windows/Linux)
   - 输入转换命令（如 "将Word转换为Markdown"）

### 批量转换
1. 右键点击包含文档的文件夹
2. 选择 "批量转换文档"
3. 按提示选择转换类型和选项

### 可用命令 (v0.4.0)
- `将Word转换为Markdown` - 转换Word文档为Markdown
- `将Markdown转换为Word` - 转换Markdown文件为Word文档 (.docx)
- `将Excel转换为Markdown` - 转换Excel文件为Markdown表格
- `将Excel转换为CSV` - 转换Excel文件为CSV格式
- `将PDF转换为文本` - 转换PDF为文本文件
- `将PDF转换为图片` - 转换PDF页面为PNG图片 *(需要poppler-utils工具)*
- `将PowerPoint转换为Markdown` - 转换PowerPoint演示文稿为Markdown
- `提取Word表格为CSV` - 从Word文档提取表格为CSV格式
- `提取PDF表格为CSV` - 从PDF文档提取表格为CSV格式
- `导出指定PDF页面为文本` - 转换选定的PDF页面为文本
- `导出指定PDF页面为图片` - 转换选定的PDF页面为图片
- `导出选定Excel工作表为Markdown` - 转换选择的工作表为Markdown
- `导出选定Excel工作表为CSV` - 转换选择的工作表为CSV
- `导出PowerPoint幻灯片为Markdown` - 转换选定的幻灯片为Markdown
- `将选定文件转换为Markdown` - 将多个选定文件转换为Markdown，支持自定义信息块
- `批量转换文档` - 批量转换文档
- `打开文档转换器` - 打开转换器界面

## 🔧 转换特性

### Markdown文档转换 ⭐ **新增 (v0.4.0)**
- **全面Markdown支持**:
  - 所有标题级别 (H1-H6)
  - 文本格式化（粗体、斜体、删除线）
  - 行内代码和代码块（带语法高亮）
  - 有序和无序列表（支持嵌套）
  - 表格支持（包括对齐）
  - 引用块和水平线
  - 链接和图片
- **专业输出**:
  - 清晰的Word文档 (.docx) 结构
  - 格式保留完美
  - 中英文和多语言支持
  - 高效的文件大小优化
- **性能优化**:
  - 快速转换（通常 < 50ms）
  - 高效处理大型文档
  - 流式输出提高内存效率
- **质量功能**:
  - 保留文档结构和层级
  - 所有元素的文本格式保留
  - 处理边界情况和复杂嵌套结构
  - 跨平台输出一致

**使用方法**:
1. 在VS Code资源管理器中右键点击 `.md` 或 `.markdown` 文件
2. 从上下文菜单选择 "将Markdown转换为Word"
3. 或使用命令面板: `Cmd+Shift+P` → "将Markdown转换为Word"
4. 输出Word文档将在同一目录中创建

### Word文档转换
- 保留文本格式（粗体、斜体等）
- 转换标题层级
- 处理列表和表格
- 支持 .docx 和 .doc 格式
- 智能超时处理（避免.doc文件卡死）

### Excel表格转换
- **转换为Markdown**: 转换为Markdown表格格式
- **转换为CSV**: 转换为CSV格式，支持多种配置选项
  - 单独文件（每个工作表一个文件）或合并文件
  - 可配置编码（UTF-8或GBK，兼容中文Excel）
  - 可配置分隔符（逗号、分号或制表符）
  - 可选元数据注释
- 保留单元格数据类型
- 处理多工作表
- 支持 .xlsx, .xls, .csv 格式
- 自动数据格式化

### PDF文档转换

#### 文本提取
- **高级文本处理算法**:
  - 智能空格修复
  - 单词边界检测
  - 标点符号格式化
  - 连字符单词重组
- **文本质量优化**:
  - 移除多余空白字符
  - 修复常见间距问题
  - 保护URL和邮箱格式
  - 句子结构优化
- **输出增强**:
  - 添加文档元数据
  - 按段落组织内容
  - Markdown格式输出

#### 图片转换 *(新功能)*
- **PDF转图片**: 将PDF页面转换为高质量PNG图片
- **工具要求**: 需要安装poppler-utils工具
- **标准设置**: 300 DPI分辨率，确保最佳质量
- **批量处理**: 支持多个PDF文件转换，带进度跟踪
- **跨平台**: 自动检测工具，提供安装指导
- **有序输出**: 创建结构化的文件夹层次结构
- **一键设置**: 当工具缺失时提供简单的安装指导

**poppler-utils安装指南**:
- **macOS**: `brew install poppler`
- **Windows**: 下载便携版本或使用包管理器
- **Linux**: `sudo apt-get install poppler-utils`
- **输出增强**:
  - 添加文档元数据
  - 按段落组织内容
  - Markdown格式输出

### PowerPoint演示文稿转换
- **幻灯片内容提取**:
  - 从所有幻灯片提取文本
  - 智能段落分组
  - 标题检测和格式化
  - 列表项识别
- **演示文稿结构**:
  - 保持幻灯片顺序和层次
  - 提取演示文稿元数据（作者、标题、主题）
  - 包含幻灯片数量和文件信息
- **演讲者备注支持**:
  - 提取和整理演讲者备注
  - 将备注链接到对应幻灯片
  - 保留备注格式
- **格式兼容性**:
  - 支持 .pptx（现代）和 .ppt（旧版）格式
  - 为 .ppt 格式提供转换指导
  - 处理复杂的演示文稿布局

## 🌐 多语言支持

扩展会根据VS Code的语言设置自动切换界面语言：
- **英文** (默认) - 适用于英文环境
- **中文** - 自动检测中文环境

支持的语言功能：
- 命令标题和描述
- 用户界面文本
- 错误消息和提示
- 配置选项说明

## 📁 输出格式

所有转换后的文件将保存在原文件同目录下的相应格式：
- Word → `.md` 文件
- Excel → `.md` 文件（包含表格）
- PDF → `.txt` 文件

## 🚀 最新功能 (v0.4.0)

### Markdown转Word转换增强 ✨
- **🆕 表格中HTML列表支持**: 完整支持表格单元格中的HTML `<ul>`、`<ol>` 和 `<li>` 标签
- **📝 完整列表渲染**: 所有列表项现在正确转换为Word列表格式（不仅仅是第一项）
- **🧪 改进的测试覆盖**: 增强的TDD实践，共306个测试通过
- **🐛 错误修复**: 修复了表格中仅第一个HTML列表项转换的问题
- **📊 质量改进**: 更好的错误处理和全面的回归测试

##  即将推出的功能 (v0.5.0+)

## ⚙️ 配置选项

扩展支持以下配置选项（在设置中搜索"文档转换器"）：
- 输出目录设置
- Excel最大行数限制
- 格式保留选项
- 自动打开结果文件

## 🛠️ 技术实现

### 依赖库
- **mammoth.js** - Word文档处理
- **xlsx** - Excel文件处理  
- **pdf-parse** - PDF文本提取
- **VS Code API** - 扩展集成

### 架构设计
```
src/
├── converters/           # 核心转换器
│   ├── wordToMarkdown.ts
│   ├── excelToMarkdown.ts
│   └── pdfToText.ts
├── commands/            # VS Code命令处理
├── i18n/               # 国际化支持
│   ├── index.ts        # 国际化管理器
│   ├── en.ts          # 英文语言包
│   └── zh-cn.ts       # 中文语言包
├── utils/              # 工具函数
├── types/              # TypeScript类型定义
└── extension.ts        # 扩展入口
```

## 🐛 故障排除

### 常见问题

1. **转换失败**
   - 检查文件是否损坏
   - 确保文件未被其他程序打开
   - 查看VS Code开发者控制台的错误信息

2. **.doc文件转换卡死**
   - 扩展已内置超时机制
   - 建议将.doc文件转换为.docx后再处理

3. **PDF文本质量差**
   - 某些PDF可能使用图像文本，建议使用OCR工具
   - 检查PDF是否为扫描件

4. **界面语言问题**
   - 扩展会自动检测VS Code语言设置
   - 支持中文(zh-cn)和英文环境
   - 可在VS Code设置中更改显示语言

### 调试模式
按 F5 在VS Code中以调试模式运行扩展，查看详细日志信息。

## 🤝 贡献

欢迎提交Issue和Pull Request来改进这个扩展！

### 开发环境设置
```bash
# 克隆仓库
git clone https://github.com/hddevteam/vscode-md-converter.git
cd vscode-md-converter

# 安装依赖
npm install

# 开发模式编译
npm run watch

# 运行测试
npm test
```

### 添加新语言支持
1. 在 `src/i18n/` 目录下创建新的语言文件
2. 在 `src/i18n/index.ts` 中添加语言检测逻辑
3. 创建对应的 `package.nls.{language}.json` 文件

## 📄 许可证

MIT License - 详见 [LICENSE](LICENSE) 文件

## 🔄 更新日志

### v0.1.5 - 2025-07-09
- ✨ **新功能：PDF表格提取** - 完整实现PDF表格提取为CSV
- 📊 **新功能：Word表格提取** - 增强Word表格提取，改进CSV输出
- 🎯 PDF文档高级表格检测算法，支持单空格分隔
- 🌏 支持复杂中文外汇表格和多列数据提取
- ⚙️ 表格输出模式选择单独文件 vs 合并文件）
- 📝 Excel兼容性，UTF-8 BOM正确显示中文字符
- 🧹 简化PDF解析架构，仅使用可靠的pdf-parse库
- 🔧 增强各种表格格式的检测（制表符、逗号、空格分隔）
- 🛠️ 更好的错误处理和用户反馈
- 📖 代码质量改进，整个代码库使用英文注释

### v0.1.4
- ✨ **新功能：PowerPoint支持** - 完整的 .pptx 演示文稿转换为 Markdown
- 🎯 智能幻灯片内容提取，具备正确的文本格式化
- 📝 演讲者备注支持，自动链接到对应幻灯片
- 🔧 增强用户体验，提供正确的进度报告
- ⚠️ 对旧版 .ppt 格式提供友好警告和转换指导
- 📊 全面的演示文稿元数据提取（作者、标题、主题、幻灯片数量）
- 🧹 代码库清理 - 移除不必要的测试命令，界面更简洁
- 🌐 更新 PowerPoint 功能的翻译和文档

### v0.1.3
- ✨ 新增批量转换时保留目录结构功能
- 🗂️ 增强子文件夹处理，保持原始层级结构
- 🔄 改进转换工作流，提供更好的进度报告
- 🌐 更新子文件夹结构功能的翻译
- 🧩 修复其他右键菜单集成问题

### v0.1.2
- ✨ 增强文件夹批量转换功能
- 🔍 新增批量转换前的文件计数预览
- 🚀 添加转换确认对话框
- ⏱️ 添加批量操作总时长统计
- 🧩 修复文件夹右键菜单集成问题
- 🌐 更新新UI元素的国际化支持

### v0.1.1
- 🎨 更新扩展品牌为"一键Markdown转换器"
- 🌐 增强带有中文版的GitHub Pages网站
- 🎨 改进配色方案，采用现代紫青色渐变
- 📚 更新国际化支持
- 🔧 增强文档和用户指南

### v0.1.0
- 🚀 发布到VS Code市场
- 🌐 添加全面的GitHub Pages网站
- 📦 专业的打包和分发
- 🎨 创建自定义扩展图标
- 📖 完整的文档和指南

### v0.0.1
- ✨ 初始版本发布
- ✅ Word转Markdown转换
- ✅ Excel转Markdown转换  
- ✅ PDF转文本转换
- ✅ 批量转换功能
- ✅ VS Code集成
- ✅ 中英文双语支持

---

**享受文档转换的便利！** 🎉
